import{_ as w}from"./DKYKsfuH.js";import{_ as P,x as F,r as b,c as m,o as c,a,b as E,i as f,u as o,h as y,v as T,n as h,t as k,d as _,H as V,g as N}from"./BWpRghuz.js";import{u as $}from"./D0YskpLl.js";const C=()=>{const p=r=>{const t=[],i=r.replace(/\D/g,"");return r?i.length!==11&&t.push("Введите корректный номер телефона"):t.push("Телефон обязателен для заполнения"),t},v=r=>{const t=[];return r?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)||t.push("Введите корректный email адрес"):t.push("Email обязателен для заполнения"),t},s=(r,t="Поле",i=1)=>{const d=[];return r?r.length<i&&d.push(`${t} должно содержать не менее ${i} символов`):d.push(`${t} обязательно для заполнения`),d},l=(r,t="Согласие")=>{const i=[];return r||i.push(`Необходимо ваше ${t.toLowerCase()}`),i};return{validatePhone:p,validateEmail:v,validateText:s,validateCheckbox:l,validateForm:(r,t={})=>{const i={},e={...{phone:{required:!0,validate:p},email:{required:!0,validate:v},message:{required:!0,validate:u=>s(u,"Описание",10)},agreedToPrivacy:{required:!0,validate:u=>l(u,"согласие на обработку данных")}},...t};return Object.keys(e).forEach(u=>{const n=e[u];if(n.required||r[u]){const x=n.validate(r[u]);x.length>0&&(i[u]=x[0])}}),{isValid:Object.keys(i).length===0,errors:i}}}},U={class:"form-group"},q={key:0,class:"error"},M={class:"form-group"},R={key:0,class:"error"},S={class:"checkbox-group"},B={class:"checkbox-item"},D={key:0,class:"error"},I={class:"checkbox-item"},O=["disabled"],j={key:0,class:"success-message"},z={__name:"FormCuestion",props:{isModal:{type:Boolean,default:!1}},setup(p){const{validateForm:v}=C(),s=F({phone:"",email:"",message:"",source_id:1,agreedToPrivacy:!1,agreedToNewsletter:!1}),l=b({}),g=b(!1),r=b(!1),t=()=>{const d=v(s);return l.value=d.errors,d.isValid},i=async()=>{if(t()){g.value=!0;try{const{data:d,error:e}=await $("/api/leads",{method:"POST",body:{phone:s.phone,email:s.email,message:s.message,sourceId:s.source_id}},"$U5l2Y3godd");if(e.value)throw new Error(e.value.data?.message||"Ошибка при отправке формы");r.value=!0,s.phone="",s.email="",s.message="",s.agreedToPrivacy=!1,s.agreedToNewsletter=!1,l.value={},setTimeout(()=>{r.value=!1},5e3)}catch(d){console.error("Ошибка при отправке формы:",d),alert("Произошла ошибка при отправке формы. Пожалуйста, попробуйте еще раз.")}finally{g.value=!1}}};return(d,e)=>{const u=w;return c(),m("div",{class:h(["form-container",{"modal-version":p.isModal}])},[e[11]||(e[11]=a("h2",null,"Задайте вопрос специалисту",-1)),e[12]||(e[12]=a("p",null,"И наш менеджер свяжется с вами.   Заполните форму и задайте вопрос",-1)),a("form",{onSubmit:N(i,["prevent"])},[E(u,{modelValue:o(s).phone,"onUpdate:modelValue":e[0]||(e[0]=n=>o(s).phone=n),error:o(l).phone},null,8,["modelValue","error"]),a("div",U,[e[5]||(e[5]=a("label",null,"Email",-1)),y(a("input",{type:"email","onUpdate:modelValue":e[1]||(e[1]=n=>o(s).email=n),placeholder:"your@email.com",class:h({error:o(l).email})},null,2),[[T,o(s).email]]),o(l).email?(c(),m("div",q,k(o(l).email),1)):f("",!0)]),a("div",M,[e[6]||(e[6]=a("label",null,"Вопрос",-1)),y(a("textarea",{"onUpdate:modelValue":e[2]||(e[2]=n=>o(s).message=n),placeholder:"Опишите ваш вопрос подробно",class:h({error:o(l).message})},null,2),[[T,o(s).message]]),o(l).message?(c(),m("div",R,k(o(l).message),1)):f("",!0)]),a("div",S,[a("label",B,[y(a("input",{type:"checkbox",id:"privacy","onUpdate:modelValue":e[3]||(e[3]=n=>o(s).agreedToPrivacy=n),class:h({error:o(l).agreedToPrivacy})},null,2),[[V,o(s).agreedToPrivacy]]),e[7]||(e[7]=a("span",{class:"checkmark"},null,-1)),e[8]||(e[8]=_(" Я согласен на обработку персональных данных ",-1))]),o(l).agreedToPrivacy?(c(),m("div",D,k(o(l).agreedToPrivacy),1)):f("",!0),a("label",I,[y(a("input",{type:"checkbox",id:"newsletter","onUpdate:modelValue":e[4]||(e[4]=n=>o(s).agreedToNewsletter=n)},null,512),[[V,o(s).agreedToNewsletter]]),e[9]||(e[9]=a("span",{class:"checkmark"},null,-1)),e[10]||(e[10]=_(" Я согласен на рассылку ",-1))])]),a("button",{type:"submit",disabled:o(g)},"Отправить запрос",8,O),o(r)?(c(),m("div",j," Спасибо! Ваш запрос успешно отправлен. Мы свяжемся с вами в ближайшее время. ")):f("",!0)],32)],2)}}},A=P(z,[["__scopeId","data-v-30cd5607"]]);export{A as _};
